Description: CVE-2015-5602: Enable sudoedit directory writability checks by default
Bug: https://bugzilla.sudo.ws/show_bug.cgi?id=707
Bug-Debian: https://bugs.debian.org/804149
Author: Ben Hutchings <ben@decadent.org.uk>
Forwarded: not-needed

--- a/defaults.c
+++ b/defaults.c
@@ -492,6 +492,7 @@ init_defaults()
 #ifdef _PATH_SUDO_NOEXEC
     def_noexec_file = estrdup(_PATH_SUDO_NOEXEC);
 #endif
+    def_sudoedit_checkdir = TRUE;
 
     /* Finally do the lists (currently just environment tables). */
     init_envtables();
--- a/sudoers.cat
+++ b/sudoers.cat
@@ -755,8 +755,8 @@ SSUUDDOOEERRSS OOPPTTIIOONN
                        directory that is writable by the invoking user unless
                        it is run by root.  On many systems, this option
                        requires that the parent directory of the file to be
-                       edited be readable by the target user.  This flag is
-                       _o_f_f by default.
+                       edited be readable by the target user.  This flag is _o_n
+                       by default.
 
        sudoedit_follow By default, ssuuddooeeddiitt will not follow symbolic links
                        when opening files.  The _s_u_d_o_e_d_i_t___f_o_l_l_o_w option can be
--- a/sudoers.man.in
+++ b/sudoers.man.in
@@ -991,7 +991,7 @@ If set, \fBsudoedit\fR will refuse to ed
 that is writable by the invoking user unless it is run by root.
 On many systems, this option requires that the parent directory of
 the file to be edited be readable by the target user.  This flag is
-\&\fIoff\fR by default.
+\&\fIon\fR by default.
 .IP "sudoedit_follow" 16
 .IX Item "sudoedit_follow"
 By default, \fBsudoedit\fR will not follow symbolic links when opening
--- a/sudoers.pod
+++ b/sudoers.pod
@@ -881,7 +881,7 @@ If set, B<sudoedit> will refuse to edit
 that is writable by the invoking user unless it is run by root.
 On many systems, this option requires that the parent directory of
 the file to be edited be readable by the target user.  This flag is
-I<off> by default.
+I<on> by default.
 
 =item sudoedit_follow
 
