Description: CVE-2015-5602: Enable sudoedit directory writability checks by default
Bug: https://bugzilla.sudo.ws/show_bug.cgi?id=707
Bug-Debian: https://bugs.debian.org/804149
Author: Ben Hutchings <ben@decadent.org.uk>
Forwarded: not-needed

--- a/plugins/sudoers/defaults.c
+++ b/plugins/sudoers/defaults.c
@@ -490,6 +490,7 @@ init_defaults(void)
     def_editor = estrdup(EDITOR);
     def_set_utmp = true;
     def_pam_setcred = true;
+    def_sudoedit_checkdir = true;
 
     /* Finally do the lists (currently just environment tables). */
     init_envtables();
--- a/doc/sudoers.cat
+++ b/doc/sudoers.cat
@@ -1208,7 +1208,7 @@ SSUUDDOOEERRSS OOPPTTIIOONN
                        it is run by root.  On many systems, this option
                        requires that the parent directory of the file to be
                        edited be readable by the target user.  This flag is
-                       _o_f_f by default.
+                       _o_n by default.
 
      sudoedit_follow   By default, ssuuddooeeddiitt will not follow symbolic links
                        when opening files.  The _s_u_d_o_e_d_i_t___f_o_l_l_o_w option can be
--- a/doc/sudoers.man.in
+++ b/doc/sudoers.man.in
@@ -2555,7 +2555,7 @@ by the invoking user unless it is run by
 On many systems, this option requires that the parent directory
 of the file to be edited be readable by the target user.
 This flag is
-\fIoff\fR
+\fIon\fR
 by default.
 .TP 18n
 sudoedit_follow
--- a/doc/sudoers.mdoc.in
+++ b/doc/sudoers.mdoc.in
@@ -2391,7 +2391,7 @@ by the invoking user unless it is run by
 On many systems, this option requires that the parent directory
 of the file to be edited be readable by the target user.
 This flag is
-.Em off
+.Em on
 by default.
 .It sudoedit_follow
 By default,
