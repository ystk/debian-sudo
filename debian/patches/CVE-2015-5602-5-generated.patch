Description: CVE-2015-5602: sudoedit path restriction bypass using symlinks
 Files regenerated for changes in CVE-2015-5602-5.patch
Bug: https://bugzilla.sudo.ws/show_bug.cgi?id=707
Bug-Debian: https://bugs.debian.org/804149
Author: Ben Hutchings <ben@decadent.org.uk>
Forwarded: not-needed

--- a/def_data.c
+++ b/def_data.c
@@ -331,6 +331,10 @@ struct sudo_defs_types sudo_defs_table[]
 	"Always run commands in a pseudo-tty",
 	NULL,
     }, {
+	"sudoedit_checkdir", T_FLAG,
+	"Check the parent directory for writability when editing files with sudoedit",
+	NULL,
+    }, {
 	"sudoedit_follow", T_FLAG,
 	"Follow symbolic links when editing files with sudoedit",
 	NULL,
--- a/def_data.h
+++ b/def_data.h
@@ -152,8 +152,10 @@
 #define I_COMPRESS_IO           75
 #define def_use_pty             (sudo_defs_table[76].sd_un.flag)
 #define I_USE_PTY               76
-#define def_sudoedit_follow     (sudo_defs_table[77].sd_un.flag)
-#define I_SUDOEDIT_FOLLOW       77
+#define def_sudoedit_checkdir   (sudo_defs_table[77].sd_un.flag)
+#define I_SUDOEDIT_CHECKDIR     77
+#define def_sudoedit_follow     (sudo_defs_table[78].sd_un.flag)
+#define I_SUDOEDIT_FOLLOW       78
 
 enum def_tupple {
 	never,
--- a/sudoers.cat
+++ b/sudoers.cat
@@ -750,6 +750,14 @@ SSUUDDOOEERRSS OOPPTTIIOONN
                        with either the _s_e_t_r_e_u_i_d_(_) or _s_e_t_r_e_s_u_i_d_(_) function.
                        This flag is _o_f_f by default.
 
+       sudoedit_checkdir
+                       If set, ssuuddooeeddiitt will refuse to edit files located in a
+                       directory that is writable by the invoking user unless
+                       it is run by root.  On many systems, this option
+                       requires that the parent directory of the file to be
+                       edited be readable by the target user.  This flag is
+                       _o_f_f by default.
+
        sudoedit_follow By default, ssuuddooeeddiitt will not follow symbolic links
                        when opening files.  The _s_u_d_o_e_d_i_t___f_o_l_l_o_w option can be
                        enabled to allow ssuuddooeeddiitt to open symbolic links.  It
--- a/sudoers.man.in
+++ b/sudoers.man.in
@@ -985,6 +985,13 @@ wrapper.  This can be useful on systems
 dangerous functionality when a program is run setuid.  This option
 is only effective on systems with either the \fIsetreuid()\fR or \fIsetresuid()\fR
 function.  This flag is \fIoff\fR by default.
+.IP "sudoedit_checkdir" 16
+.IX Item "sudoedit_checkdir"
+If set, \fBsudoedit\fR will refuse to edit files located in a directory
+that is writable by the invoking user unless it is run by root.
+On many systems, this option requires that the parent directory of
+the file to be edited be readable by the target user.  This flag is
+\&\fIoff\fR by default.
 .IP "sudoedit_follow" 16
 .IX Item "sudoedit_follow"
 By default, \fBsudoedit\fR will not follow symbolic links when opening
--- a/config.h.in
+++ b/config.h.in
@@ -358,6 +358,9 @@
 /* Define to 1 if you have the <netgroup.h> header file. */
 #undef HAVE_NETGROUP_H
 
+/* Define to 1 if you have the `openat' function. */
+#undef HAVE_OPENAT
+
 /* Define to 1 if you have the `openpty' function. */
 #undef HAVE_OPENPTY
 
--- a/configure
+++ b/configure
@@ -1,13 +1,13 @@
 #! /bin/sh
 # Guess values for system-dependent variables and create Makefiles.
-# Generated by GNU Autoconf 2.65 for sudo 1.7.4p4.
+# Generated by GNU Autoconf 2.67 for sudo 1.7.4p4.
 #
 # Report bugs to <http://www.sudo.ws/bugs/>.
 #
 #
 # Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
-# 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009 Free Software Foundation,
-# Inc.
+# 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010 Free Software
+# Foundation, Inc.
 #
 #
 # This configure script is free software; the Free Software Foundation
@@ -319,7 +319,7 @@ $as_echo X"$as_dir" |
       test -d "$as_dir" && break
     done
     test -z "$as_dirs" || eval "mkdir $as_dirs"
-  } || test -d "$as_dir" || as_fn_error "cannot create directory $as_dir"
+  } || test -d "$as_dir" || as_fn_error $? "cannot create directory $as_dir"
 
 
 } # as_fn_mkdir_p
@@ -359,19 +359,19 @@ else
 fi # as_fn_arith
 
 
-# as_fn_error ERROR [LINENO LOG_FD]
-# ---------------------------------
+# as_fn_error STATUS ERROR [LINENO LOG_FD]
+# ----------------------------------------
 # Output "`basename $0`: error: ERROR" to stderr. If LINENO and LOG_FD are
 # provided, also output the error to LOG_FD, referencing LINENO. Then exit the
-# script with status $?, using 1 if that was 0.
+# script with STATUS, using 1 if that was 0.
 as_fn_error ()
 {
-  as_status=$?; test $as_status -eq 0 && as_status=1
-  if test "$3"; then
-    as_lineno=${as_lineno-"$2"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-    $as_echo "$as_me:${as_lineno-$LINENO}: error: $1" >&$3
+  as_status=$1; test $as_status -eq 0 && as_status=1
+  if test "$4"; then
+    as_lineno=${as_lineno-"$3"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+    $as_echo "$as_me:${as_lineno-$LINENO}: error: $2" >&$4
   fi
-  $as_echo "$as_me: error: $1" >&2
+  $as_echo "$as_me: error: $2" >&2
   as_fn_exit $as_status
 } # as_fn_error
 
@@ -682,7 +682,7 @@ test -n "$DJDIR" || exec 7<&0 </dev/null
 exec 6>&1
 
 # Name of the host.
-# hostname on some systems (SVR3.2, Linux) returns a bogus exit status,
+# hostname on some systems (SVR3.2, old GNU/Linux) returns a bogus exit status,
 # so uname gets run too.
 ac_hostname=`(hostname || uname -n) 2>/dev/null | sed 1q`
 
@@ -1074,8 +1074,9 @@ do
   fi
 
   case $ac_option in
-  *=*)	ac_optarg=`expr "X$ac_option" : '[^=]*=\(.*\)'` ;;
-  *)	ac_optarg=yes ;;
+  *=?*) ac_optarg=`expr "X$ac_option" : '[^=]*=\(.*\)'` ;;
+  *=)   ac_optarg= ;;
+  *)    ac_optarg=yes ;;
   esac
 
   # Accept the important Cygnus configure options, so we can diagnose typos.
@@ -1120,7 +1121,7 @@ do
     ac_useropt=`expr "x$ac_option" : 'x-*disable-\(.*\)'`
     # Reject names that are not valid shell variable names.
     expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
-      as_fn_error "invalid feature name: $ac_useropt"
+      as_fn_error $? "invalid feature name: $ac_useropt"
     ac_useropt_orig=$ac_useropt
     ac_useropt=`$as_echo "$ac_useropt" | sed 's/[-+.]/_/g'`
     case $ac_user_opts in
@@ -1146,7 +1147,7 @@ do
     ac_useropt=`expr "x$ac_option" : 'x-*enable-\([^=]*\)'`
     # Reject names that are not valid shell variable names.
     expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
-      as_fn_error "invalid feature name: $ac_useropt"
+      as_fn_error $? "invalid feature name: $ac_useropt"
     ac_useropt_orig=$ac_useropt
     ac_useropt=`$as_echo "$ac_useropt" | sed 's/[-+.]/_/g'`
     case $ac_user_opts in
@@ -1350,7 +1351,7 @@ do
     ac_useropt=`expr "x$ac_option" : 'x-*with-\([^=]*\)'`
     # Reject names that are not valid shell variable names.
     expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
-      as_fn_error "invalid package name: $ac_useropt"
+      as_fn_error $? "invalid package name: $ac_useropt"
     ac_useropt_orig=$ac_useropt
     ac_useropt=`$as_echo "$ac_useropt" | sed 's/[-+.]/_/g'`
     case $ac_user_opts in
@@ -1366,7 +1367,7 @@ do
     ac_useropt=`expr "x$ac_option" : 'x-*without-\(.*\)'`
     # Reject names that are not valid shell variable names.
     expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
-      as_fn_error "invalid package name: $ac_useropt"
+      as_fn_error $? "invalid package name: $ac_useropt"
     ac_useropt_orig=$ac_useropt
     ac_useropt=`$as_echo "$ac_useropt" | sed 's/[-+.]/_/g'`
     case $ac_user_opts in
@@ -1396,8 +1397,8 @@ do
   | --x-librar=* | --x-libra=* | --x-libr=* | --x-lib=* | --x-li=* | --x-l=*)
     x_libraries=$ac_optarg ;;
 
-  -*) as_fn_error "unrecognized option: \`$ac_option'
-Try \`$0 --help' for more information."
+  -*) as_fn_error $? "unrecognized option: \`$ac_option'
+Try \`$0 --help' for more information"
     ;;
 
   *=*)
@@ -1405,7 +1406,7 @@ Try \`$0 --help' for more information."
     # Reject names that are not valid shell variable names.
     case $ac_envvar in #(
       '' | [0-9]* | *[!_$as_cr_alnum]* )
-      as_fn_error "invalid variable name: \`$ac_envvar'" ;;
+      as_fn_error $? "invalid variable name: \`$ac_envvar'" ;;
     esac
     eval $ac_envvar=\$ac_optarg
     export $ac_envvar ;;
@@ -1423,13 +1424,13 @@ done
 
 if test -n "$ac_prev"; then
   ac_option=--`echo $ac_prev | sed 's/_/-/g'`
-  as_fn_error "missing argument to $ac_option"
+  as_fn_error $? "missing argument to $ac_option"
 fi
 
 if test -n "$ac_unrecognized_opts"; then
   case $enable_option_checking in
     no) ;;
-    fatal) as_fn_error "unrecognized options: $ac_unrecognized_opts" ;;
+    fatal) as_fn_error $? "unrecognized options: $ac_unrecognized_opts" ;;
     *)     $as_echo "$as_me: WARNING: unrecognized options: $ac_unrecognized_opts" >&2 ;;
   esac
 fi
@@ -1452,7 +1453,7 @@ do
     [\\/$]* | ?:[\\/]* )  continue;;
     NONE | '' ) case $ac_var in *prefix ) continue;; esac;;
   esac
-  as_fn_error "expected an absolute directory name for --$ac_var: $ac_val"
+  as_fn_error $? "expected an absolute directory name for --$ac_var: $ac_val"
 done
 
 # There might be people who depend on the old broken behavior: `$host'
@@ -1466,8 +1467,8 @@ target=$target_alias
 if test "x$host_alias" != x; then
   if test "x$build_alias" = x; then
     cross_compiling=maybe
-    $as_echo "$as_me: WARNING: If you wanted to set the --build type, don't use --host.
-    If a cross compiler is detected then cross compile mode will be used." >&2
+    $as_echo "$as_me: WARNING: if you wanted to set the --build type, don't use --host.
+    If a cross compiler is detected then cross compile mode will be used" >&2
   elif test "x$build_alias" != "x$host_alias"; then
     cross_compiling=yes
   fi
@@ -1482,9 +1483,9 @@ test "$silent" = yes && exec 6>/dev/null
 ac_pwd=`pwd` && test -n "$ac_pwd" &&
 ac_ls_di=`ls -di .` &&
 ac_pwd_ls_di=`cd "$ac_pwd" && ls -di .` ||
-  as_fn_error "working directory cannot be determined"
+  as_fn_error $? "working directory cannot be determined"
 test "X$ac_ls_di" = "X$ac_pwd_ls_di" ||
-  as_fn_error "pwd does not report name of working directory"
+  as_fn_error $? "pwd does not report name of working directory"
 
 
 # Find the source files, if location was not specified.
@@ -1523,11 +1524,11 @@ else
 fi
 if test ! -r "$srcdir/$ac_unique_file"; then
   test "$ac_srcdir_defaulted" = yes && srcdir="$ac_confdir or .."
-  as_fn_error "cannot find sources ($ac_unique_file) in $srcdir"
+  as_fn_error $? "cannot find sources ($ac_unique_file) in $srcdir"
 fi
 ac_msg="sources are in $srcdir, but \`cd $srcdir' does not work"
 ac_abs_confdir=`(
-	cd "$srcdir" && test -r "./$ac_unique_file" || as_fn_error "$ac_msg"
+	cd "$srcdir" && test -r "./$ac_unique_file" || as_fn_error $? "$ac_msg"
 	pwd)`
 # When building in place, set srcdir=.
 if test "$ac_abs_confdir" = "$ac_pwd"; then
@@ -1567,7 +1568,7 @@ Configuration:
       --help=short        display options specific to this package
       --help=recursive    display the short help of all the included packages
   -V, --version           display version information and exit
-  -q, --quiet, --silent   do not print \`checking...' messages
+  -q, --quiet, --silent   do not print \`checking ...' messages
       --cache-file=FILE   cache test results in FILE [disabled]
   -C, --config-cache      alias for \`--cache-file=config.cache'
   -n, --no-create         do not create output files
@@ -1590,7 +1591,7 @@ Fine tuning of the installation director
   --bindir=DIR            user executables [EPREFIX/bin]
   --sbindir=DIR           system admin executables [EPREFIX/sbin]
   --libexecdir=DIR        program executables [EPREFIX/libexec]
-  --sysconfdir=DIR        read-only single-machine data [/etc]
+  --sysconfdir=DIR        read-only single-machine data [PREFIX/etc]
   --sharedstatedir=DIR    modifiable architecture-independent data [PREFIX/com]
   --localstatedir=DIR     modifiable single-machine data [PREFIX/var]
   --libdir=DIR            object code libraries [EPREFIX/lib]
@@ -1831,9 +1832,9 @@ test -n "$ac_init_help" && exit $ac_stat
 if $ac_init_version; then
   cat <<\_ACEOF
 sudo configure 1.7.4p4
-generated by GNU Autoconf 2.65
+generated by GNU Autoconf 2.67
 
-Copyright (C) 2009 Free Software Foundation, Inc.
+Copyright (C) 2010 Free Software Foundation, Inc.
 This configure script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it.
 _ACEOF
@@ -1949,7 +1950,7 @@ $as_echo "$ac_try_echo"; } >&5
     mv -f conftest.er1 conftest.err
   fi
   $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; } >/dev/null && {
+  test $ac_status = 0; } > conftest.i && {
 	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
 	 test ! -s conftest.err
        }; then :
@@ -1974,7 +1975,7 @@ ac_fn_c_check_header_compile ()
   as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
   { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2" >&5
 $as_echo_n "checking for $2... " >&6; }
-if { as_var=$3; eval "test \"\${$as_var+set}\" = set"; }; then :
+if eval "test \"\${$3+set}\"" = set; then :
   $as_echo_n "(cached) " >&6
 else
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
@@ -2046,7 +2047,7 @@ ac_fn_c_check_func ()
   as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
   { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2" >&5
 $as_echo_n "checking for $2... " >&6; }
-if { as_var=$3; eval "test \"\${$as_var+set}\" = set"; }; then :
+if eval "test \"\${$3+set}\"" = set; then :
   $as_echo_n "(cached) " >&6
 else
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
@@ -2113,10 +2114,10 @@ $as_echo "$ac_res" >&6; }
 ac_fn_c_check_header_mongrel ()
 {
   as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-  if { as_var=$3; eval "test \"\${$as_var+set}\" = set"; }; then :
+  if eval "test \"\${$3+set}\"" = set; then :
   { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2" >&5
 $as_echo_n "checking for $2... " >&6; }
-if { as_var=$3; eval "test \"\${$as_var+set}\" = set"; }; then :
+if eval "test \"\${$3+set}\"" = set; then :
   $as_echo_n "(cached) " >&6
 fi
 eval ac_res=\$$3
@@ -2152,7 +2153,7 @@ if ac_fn_c_try_cpp "$LINENO"; then :
 else
   ac_header_preproc=no
 fi
-rm -f conftest.err conftest.$ac_ext
+rm -f conftest.err conftest.i conftest.$ac_ext
 { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_header_preproc" >&5
 $as_echo "$ac_header_preproc" >&6; }
 
@@ -2175,17 +2176,15 @@ $as_echo "$as_me: WARNING: $2: see the A
 $as_echo "$as_me: WARNING: $2:     section \"Present But Cannot Be Compiled\"" >&2;}
     { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $2: proceeding with the compiler's result" >&5
 $as_echo "$as_me: WARNING: $2: proceeding with the compiler's result" >&2;}
-( cat <<\_ASBOX
-## --------------------------------------- ##
+( $as_echo "## --------------------------------------- ##
 ## Report this to http://www.sudo.ws/bugs/ ##
-## --------------------------------------- ##
-_ASBOX
+## --------------------------------------- ##"
      ) | sed "s/^/$as_me: WARNING:     /" >&2
     ;;
 esac
   { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2" >&5
 $as_echo_n "checking for $2... " >&6; }
-if { as_var=$3; eval "test \"\${$as_var+set}\" = set"; }; then :
+if eval "test \"\${$3+set}\"" = set; then :
   $as_echo_n "(cached) " >&6
 else
   eval "$3=\$ac_header_compiler"
@@ -2207,7 +2206,7 @@ ac_fn_c_check_type ()
   as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
   { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2" >&5
 $as_echo_n "checking for $2... " >&6; }
-if { as_var=$3; eval "test \"\${$as_var+set}\" = set"; }; then :
+if eval "test \"\${$3+set}\"" = set; then :
   $as_echo_n "(cached) " >&6
 else
   eval "$3=no"
@@ -2439,7 +2438,7 @@ ac_fn_c_check_member ()
   as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
   { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2.$3" >&5
 $as_echo_n "checking for $2.$3... " >&6; }
-if { as_var=$4; eval "test \"\${$as_var+set}\" = set"; }; then :
+if eval "test \"\${$4+set}\"" = set; then :
   $as_echo_n "(cached) " >&6
 else
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
@@ -2487,15 +2486,18 @@ $as_echo "$ac_res" >&6; }
 
 } # ac_fn_c_check_member
 
-# ac_fn_c_check_decl LINENO SYMBOL VAR
-# ------------------------------------
-# Tests whether SYMBOL is declared, setting cache variable VAR accordingly.
+# ac_fn_c_check_decl LINENO SYMBOL VAR INCLUDES
+# ---------------------------------------------
+# Tests whether SYMBOL is declared in INCLUDES, setting cache variable VAR
+# accordingly.
 ac_fn_c_check_decl ()
 {
   as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether $2 is declared" >&5
-$as_echo_n "checking whether $2 is declared... " >&6; }
-if { as_var=$3; eval "test \"\${$as_var+set}\" = set"; }; then :
+  as_decl_name=`echo $2|sed 's/ *(.*//'`
+  as_decl_use=`echo $2|sed -e 's/(/((/' -e 's/)/) 0&/' -e 's/,/) 0& (/g'`
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether $as_decl_name is declared" >&5
+$as_echo_n "checking whether $as_decl_name is declared... " >&6; }
+if eval "test \"\${$3+set}\"" = set; then :
   $as_echo_n "(cached) " >&6
 else
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
@@ -2504,8 +2506,12 @@ $4
 int
 main ()
 {
-#ifndef $2
-  (void) $2;
+#ifndef $as_decl_name
+#ifdef __cplusplus
+  (void) $as_decl_use;
+#else
+  (void) $as_decl_name;
+#endif
 #endif
 
   ;
@@ -2530,7 +2536,7 @@ This file contains any messages produced
 running configure, to aid debugging if configure makes a mistake.
 
 It was created by sudo $as_me 1.7.4p4, which was
-generated by GNU Autoconf 2.65.  Invocation command line was
+generated by GNU Autoconf 2.67.  Invocation command line was
 
   $ $0 $@
 
@@ -2640,11 +2646,9 @@ trap 'exit_status=$?
   {
     echo
 
-    cat <<\_ASBOX
-## ---------------- ##
+    $as_echo "## ---------------- ##
 ## Cache variables. ##
-## ---------------- ##
-_ASBOX
+## ---------------- ##"
     echo
     # The following way of writing the cache mishandles newlines in values,
 (
@@ -2678,11 +2682,9 @@ $as_echo "$as_me: WARNING: cache variabl
 )
     echo
 
-    cat <<\_ASBOX
-## ----------------- ##
+    $as_echo "## ----------------- ##
 ## Output variables. ##
-## ----------------- ##
-_ASBOX
+## ----------------- ##"
     echo
     for ac_var in $ac_subst_vars
     do
@@ -2695,11 +2697,9 @@ _ASBOX
     echo
 
     if test -n "$ac_subst_files"; then
-      cat <<\_ASBOX
-## ------------------- ##
+      $as_echo "## ------------------- ##
 ## File substitutions. ##
-## ------------------- ##
-_ASBOX
+## ------------------- ##"
       echo
       for ac_var in $ac_subst_files
       do
@@ -2713,11 +2713,9 @@ _ASBOX
     fi
 
     if test -s confdefs.h; then
-      cat <<\_ASBOX
-## ----------- ##
+      $as_echo "## ----------- ##
 ## confdefs.h. ##
-## ----------- ##
-_ASBOX
+## ----------- ##"
       echo
       cat confdefs.h
       echo
@@ -2772,7 +2770,12 @@ _ACEOF
 ac_site_file1=NONE
 ac_site_file2=NONE
 if test -n "$CONFIG_SITE"; then
-  ac_site_file1=$CONFIG_SITE
+  # We do not want a PATH search for config.site.
+  case $CONFIG_SITE in #((
+    -*)  ac_site_file1=./$CONFIG_SITE;;
+    */*) ac_site_file1=$CONFIG_SITE;;
+    *)   ac_site_file1=./$CONFIG_SITE;;
+  esac
 elif test "x$prefix" != xNONE; then
   ac_site_file1=$prefix/share/config.site
   ac_site_file2=$prefix/etc/config.site
@@ -2787,7 +2790,11 @@ do
     { $as_echo "$as_me:${as_lineno-$LINENO}: loading site script $ac_site_file" >&5
 $as_echo "$as_me: loading site script $ac_site_file" >&6;}
     sed 's/^/| /' "$ac_site_file" >&5
-    . "$ac_site_file"
+    . "$ac_site_file" \
+      || { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
+as_fn_error $? "failed to load site script $ac_site_file
+See \`config.log' for more details" "$LINENO" 5 ; }
   fi
 done
 
@@ -2863,7 +2870,7 @@ if $ac_cache_corrupted; then
 $as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
   { $as_echo "$as_me:${as_lineno-$LINENO}: error: changes in the environment can compromise the build" >&5
 $as_echo "$as_me: error: changes in the environment can compromise the build" >&2;}
-  as_fn_error "run \`make distclean' and/or \`rm $cache_file' and start over" "$LINENO" 5
+  as_fn_error $? "run \`make distclean' and/or \`rm $cache_file' and start over" "$LINENO" 5
 fi
 ## -------------------- ##
 ## Main body of script. ##
@@ -3073,9 +3080,9 @@ fi
 # Check whether --with-CC was given.
 if test "${with_CC+set}" = set; then :
   withval=$with_CC; case $with_CC in
-    yes)	as_fn_error "\"must give --with-CC an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-CC an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"illegal argument: --without-CC.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"illegal argument: --without-CC.\"" "$LINENO" 5
 		;;
     *)		CC=$with_CC
 		;;
@@ -3088,7 +3095,7 @@ fi
 if test "${with_rpath+set}" = set; then :
   withval=$with_rpath; case $with_rpath in
     yes|no)	;;
-    *)		as_fn_error "\"--with-rpath does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-rpath does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -3116,7 +3123,7 @@ if test "${with_bsm_audit+set}" = set; t
 		SUDO_OBJS="${SUDO_OBJS} bsm_audit.o"
 		;;
     no)		;;
-    *)		as_fn_error "\"--with-bsm-audit does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-bsm-audit does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -3422,8 +3429,8 @@ fi
 
 test -z "$CC" && { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
 $as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error "no acceptable C compiler found in \$PATH
-See \`config.log' for more details." "$LINENO" 5; }
+as_fn_error $? "no acceptable C compiler found in \$PATH
+See \`config.log' for more details" "$LINENO" 5 ; }
 
 # Provide some information about the compiler.
 $as_echo "$as_me:${as_lineno-$LINENO}: checking for C compiler version" >&5
@@ -3537,9 +3544,8 @@ sed 's/^/| /' conftest.$ac_ext >&5
 
 { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
 $as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-{ as_fn_set_status 77
-as_fn_error "C compiler cannot create executables
-See \`config.log' for more details." "$LINENO" 5; }; }
+as_fn_error 77 "C compiler cannot create executables
+See \`config.log' for more details" "$LINENO" 5 ; }
 else
   { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
 $as_echo "yes" >&6; }
@@ -3581,8 +3587,8 @@ done
 else
   { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
 $as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error "cannot compute suffix of executables: cannot compile and link
-See \`config.log' for more details." "$LINENO" 5; }
+as_fn_error $? "cannot compute suffix of executables: cannot compile and link
+See \`config.log' for more details" "$LINENO" 5 ; }
 fi
 rm -f conftest conftest$ac_cv_exeext
 { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_exeext" >&5
@@ -3639,9 +3645,9 @@ $as_echo "$ac_try_echo"; } >&5
     else
 	{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
 $as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error "cannot run C compiled programs.
+as_fn_error $? "cannot run C compiled programs.
 If you meant to cross compile, use \`--host'.
-See \`config.log' for more details." "$LINENO" 5; }
+See \`config.log' for more details" "$LINENO" 5 ; }
     fi
   fi
 fi
@@ -3692,8 +3698,8 @@ sed 's/^/| /' conftest.$ac_ext >&5
 
 { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
 $as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error "cannot compute suffix of object files: cannot compile
-See \`config.log' for more details." "$LINENO" 5; }
+as_fn_error $? "cannot compute suffix of object files: cannot compile
+See \`config.log' for more details" "$LINENO" 5 ; }
 fi
 rm -f conftest.$ac_cv_objext conftest.$ac_ext
 fi
@@ -3939,13 +3945,13 @@ if ac_fn_c_try_compile "$LINENO"; then :
 
 else
 
-		    as_fn_error "unable to find AUDIT_USER_CMD in libaudit.h for --with-linux-audit" "$LINENO" 5
+		    as_fn_error $? "unable to find AUDIT_USER_CMD in libaudit.h for --with-linux-audit" "$LINENO" 5
 
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
 		;;
     no)		;;
-    *)		as_fn_error "\"--with-linux-audit does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-linux-audit does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -3955,9 +3961,9 @@ fi
 # Check whether --with-incpath was given.
 if test "${with_incpath+set}" = set; then :
   withval=$with_incpath; case $with_incpath in
-    yes)	as_fn_error "\"must give --with-incpath an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-incpath an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-incpath not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-incpath not supported.\"" "$LINENO" 5
 		;;
     *)		{ $as_echo "$as_me:${as_lineno-$LINENO}: Adding ${with_incpath} to CPPFLAGS" >&5
 $as_echo "$as_me: Adding ${with_incpath} to CPPFLAGS" >&6;}
@@ -3973,9 +3979,9 @@ fi
 # Check whether --with-libpath was given.
 if test "${with_libpath+set}" = set; then :
   withval=$with_libpath; case $with_libpath in
-    yes)	as_fn_error "\"must give --with-libpath an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-libpath an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-libpath not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-libpath not supported.\"" "$LINENO" 5
 		;;
     *)		{ $as_echo "$as_me:${as_lineno-$LINENO}: Adding ${with_libpath} to LDFLAGS" >&5
 $as_echo "$as_me: Adding ${with_libpath} to LDFLAGS" >&6;}
@@ -3988,9 +3994,9 @@ fi
 # Check whether --with-libraries was given.
 if test "${with_libraries+set}" = set; then :
   withval=$with_libraries; case $with_libraries in
-    yes)	as_fn_error "\"must give --with-libraries an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-libraries an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-libraries not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-libraries not supported.\"" "$LINENO" 5
 		;;
     *)		{ $as_echo "$as_me:${as_lineno-$LINENO}: Adding ${with_libraries} to LIBS" >&5
 $as_echo "$as_me: Adding ${with_libraries} to LIBS" >&6;}
@@ -4052,7 +4058,7 @@ $as_echo "$with_passwd" >&6; }
 		AUTH_DEF=""
 		test "$with_passwd" = "yes" && AUTH_REG="$AUTH_REG passwd"
 		;;
-    *)		as_fn_error "\"Sorry, --with-passwd does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"Sorry, --with-passwd does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4108,7 +4114,7 @@ $as_echo "yes" >&6; }
 		;;
     no)		long_otp_prompt=off
 		;;
-    *)		as_fn_error "\"--with-long-otp-prompt does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-long-otp-prompt does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4184,7 +4190,7 @@ if test "${with_aixauth+set}" = set; the
   withval=$with_aixauth; case $with_aixauth in
     yes)	AUTH_EXCL="$AUTH_EXCL AIX_AUTH";;
     no)		;;
-    *)		as_fn_error "\"--with-aixauth does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-aixauth does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4196,7 +4202,7 @@ if test "${with_pam+set}" = set; then :
   withval=$with_pam; case $with_pam in
     yes)	AUTH_EXCL="$AUTH_EXCL PAM";;
     no)		;;
-    *)		as_fn_error "\"--with-pam does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-pam does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4215,7 +4221,7 @@ $as_echo "yes" >&6; }
 		AUTH_REG="$AUTH_REG AFS"
 		;;
     no)		;;
-    *)		as_fn_error "\"--with-AFS does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-AFS does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4234,7 +4240,7 @@ $as_echo "yes" >&6; }
 		AUTH_REG="$AUTH_REG DCE"
 		;;
     no)		;;
-    *)		as_fn_error "\"--with-DCE does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-DCE does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4245,7 +4251,7 @@ fi
 if test "${with_logincap+set}" = set; then :
   withval=$with_logincap; case $with_logincap in
     yes|no)	;;
-    *)		as_fn_error "\"--with-logincap does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-logincap does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4257,7 +4263,7 @@ if test "${with_bsdauth+set}" = set; the
   withval=$with_bsdauth; case $with_bsdauth in
     yes)	AUTH_EXCL="$AUTH_EXCL BSD_AUTH";;
     no)		;;
-    *)		as_fn_error "\"--with-bsdauth does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-bsdauth does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4269,7 +4275,7 @@ if test "${with_project+set}" = set; the
   withval=$with_project; case $with_project in
     yes|no)	;;
     no)	;;
-    *)		as_fn_error "\"--with-project does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-project does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4285,7 +4291,7 @@ if test "${with_lecture+set}" = set; the
 		;;
     no|none|never)	lecture=never
 		;;
-    *)		as_fn_error "\"unknown argument to --with-lecture: $with_lecture\"" "$LINENO" 5
+    *)		as_fn_error $? "\"unknown argument to --with-lecture: $with_lecture\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4306,9 +4312,9 @@ $as_echo_n "checking whether sudo should
 # Check whether --with-logging was given.
 if test "${with_logging+set}" = set; then :
   withval=$with_logging; case $with_logging in
-    yes)	as_fn_error "\"must give --with-logging an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-logging an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-logging not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-logging not supported.\"" "$LINENO" 5
 		;;
     syslog)	$as_echo "#define LOGGING SLOG_SYSLOG" >>confdefs.h
 
@@ -4325,7 +4331,7 @@ $as_echo "file" >&6; }
 		{ $as_echo "$as_me:${as_lineno-$LINENO}: result: both" >&5
 $as_echo "both" >&6; }
 		;;
-    *)		as_fn_error "\"unknown argument to --with-logging: $with_logging\"" "$LINENO" 5
+    *)		as_fn_error $? "\"unknown argument to --with-logging: $with_logging\"" "$LINENO" 5
 		;;
 esac
 else
@@ -4339,13 +4345,13 @@ fi
 # Check whether --with-logfac was given.
 if test "${with_logfac+set}" = set; then :
   withval=$with_logfac; case $with_logfac in
-    yes)	as_fn_error "\"must give --with-logfac an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-logfac an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-logfac not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-logfac not supported.\"" "$LINENO" 5
 		;;
     authpriv|auth|daemon|user|local0|local1|local2|local3|local4|local5|local6|local7)		logfac=$with_logfac
 		;;
-    *)		as_fn_error "\"$with_logfac is not a supported syslog facility.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"$with_logfac is not a supported syslog facility.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4357,14 +4363,14 @@ $as_echo_n "checking at which syslog pri
 # Check whether --with-goodpri was given.
 if test "${with_goodpri+set}" = set; then :
   withval=$with_goodpri; case $with_goodpri in
-    yes)	as_fn_error "\"must give --with-goodpri an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-goodpri an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-goodpri not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-goodpri not supported.\"" "$LINENO" 5
 		;;
     alert|crit|debug|emerg|err|info|notice|warning)
 		goodpri=$with_goodpri
 		;;
-    *)		as_fn_error "\"$with_goodpri is not a supported syslog priority.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"$with_goodpri is not a supported syslog priority.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4383,14 +4389,14 @@ $as_echo_n "checking at which syslog pri
 # Check whether --with-badpri was given.
 if test "${with_badpri+set}" = set; then :
   withval=$with_badpri; case $with_badpri in
-    yes)	as_fn_error "\"must give --with-badpri an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-badpri an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-badpri not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-badpri not supported.\"" "$LINENO" 5
 		;;
     alert|crit|debug|emerg|err|info|notice|warning)
 		badpri=$with_badpri
 		;;
-    *)		as_fn_error "$with_badpri is not a supported syslog priority." "$LINENO" 5
+    *)		as_fn_error $? "$with_badpri is not a supported syslog priority." "$LINENO" 5
 		;;
 esac
 fi
@@ -4407,9 +4413,9 @@ $as_echo "$badpri" >&6; }
 # Check whether --with-logpath was given.
 if test "${with_logpath+set}" = set; then :
   withval=$with_logpath; case $with_logpath in
-    yes)	as_fn_error "\"must give --with-logpath an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-logpath an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-logpath not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-logpath not supported.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4421,13 +4427,13 @@ $as_echo_n "checking how long a line in
 # Check whether --with-loglen was given.
 if test "${with_loglen+set}" = set; then :
   withval=$with_loglen; case $with_loglen in
-    yes)	as_fn_error "\"must give --with-loglen an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-loglen an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-loglen not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-loglen not supported.\"" "$LINENO" 5
 		;;
     [0-9]*)	loglen=$with_loglen
 		;;
-    *)		as_fn_error "\"you must enter a number, not $with_loglen\"" "$LINENO" 5
+    *)		as_fn_error $? "\"you must enter a number, not $with_loglen\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4450,7 +4456,7 @@ if test "${with_ignore_dot+set}" = set;
 		;;
     no)		ignore_dot=off
 		;;
-    *)		as_fn_error "\"--with-ignore-dot does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-ignore-dot does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4475,7 +4481,7 @@ if test "${with_mail_if_no_user+set}" =
 		;;
     no)		mail_no_user=off
 		;;
-    *)		as_fn_error "\"--with-mail-if-no-user does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-mail-if-no-user does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4500,7 +4506,7 @@ if test "${with_mail_if_no_host+set}" =
 		;;
     no)		mail_no_host=off
 		;;
-    *)		as_fn_error "\"--with-mail-if-no-host does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-mail-if-no-host does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4525,7 +4531,7 @@ if test "${with_mail_if_noperms+set}" =
 		;;
     no)		mail_noperms=off
 		;;
-    *)		as_fn_error "\"--with-mail-if-noperms does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-mail-if-noperms does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4546,9 +4552,9 @@ $as_echo_n "checking who should get the
 # Check whether --with-mailto was given.
 if test "${with_mailto+set}" = set; then :
   withval=$with_mailto; case $with_mailto in
-    yes)	as_fn_error "\"must give --with-mailto an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-mailto an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-mailto not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-mailto not supported.\"" "$LINENO" 5
 		;;
     *)		mailto=$with_mailto
 		;;
@@ -4567,7 +4573,7 @@ $as_echo "$mailto" >&6; }
 # Check whether --with-mailsubject was given.
 if test "${with_mailsubject+set}" = set; then :
   withval=$with_mailsubject; case $with_mailsubject in
-    yes)	as_fn_error "\"must give --with-mailsubject an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-mailsubject an argument.\"" "$LINENO" 5
 		;;
     no)		{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: Sorry, --without-mailsubject not supported." >&5
 $as_echo "$as_me: WARNING: Sorry, --without-mailsubject not supported." >&2;}
@@ -4593,7 +4599,7 @@ $as_echo_n "checking for bad password pr
 # Check whether --with-passprompt was given.
 if test "${with_passprompt+set}" = set; then :
   withval=$with_passprompt; case $with_passprompt in
-    yes)	as_fn_error "\"must give --with-passprompt an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-passprompt an argument.\"" "$LINENO" 5
 		;;
     no)		{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: Sorry, --without-passprompt not supported." >&5
 $as_echo "$as_me: WARNING: Sorry, --without-passprompt not supported." >&2;}
@@ -4616,7 +4622,7 @@ $as_echo_n "checking for bad password me
 # Check whether --with-badpass-message was given.
 if test "${with_badpass_message+set}" = set; then :
   withval=$with_badpass_message; case $with_badpass_message in
-    yes)	as_fn_error "\"Must give --with-badpass-message an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"Must give --with-badpass-message an argument.\"" "$LINENO" 5
 		;;
     no)		{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: Sorry, --without-badpass-message not supported." >&5
 $as_echo "$as_me: WARNING: Sorry, --without-badpass-message not supported." >&2;}
@@ -4644,7 +4650,7 @@ if test "${with_fqdn+set}" = set; then :
 		;;
     no)		fqdn=off
 		;;
-    *)		as_fn_error "\"--with-fqdn does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-fqdn does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4663,9 +4669,9 @@ fi
 # Check whether --with-timedir was given.
 if test "${with_timedir+set}" = set; then :
   withval=$with_timedir; case $with_timedir in
-    yes)	as_fn_error "\"must give --with-timedir an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-timedir an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-timedir not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-timedir not supported.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4711,15 +4717,15 @@ fi
 # Check whether --with-sudoers-mode was given.
 if test "${with_sudoers_mode+set}" = set; then :
   withval=$with_sudoers_mode; case $with_sudoers_mode in
-    yes)	as_fn_error "\"must give --with-sudoers-mode an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-sudoers-mode an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-sudoers-mode not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-sudoers-mode not supported.\"" "$LINENO" 5
 		;;
     [1-9]*)	SUDOERS_MODE=0${with_sudoers_mode}
 		;;
     0*)		SUDOERS_MODE=$with_sudoers_mode
 		;;
-    *)		as_fn_error "\"you must use an octal mode, not a name.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"you must use an octal mode, not a name.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4729,13 +4735,13 @@ fi
 # Check whether --with-sudoers-uid was given.
 if test "${with_sudoers_uid+set}" = set; then :
   withval=$with_sudoers_uid; case $with_sudoers_uid in
-    yes)	as_fn_error "\"must give --with-sudoers-uid an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-sudoers-uid an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-sudoers-uid not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-sudoers-uid not supported.\"" "$LINENO" 5
 		;;
     [0-9]*)	SUDOERS_UID=$with_sudoers_uid
 		;;
-    *)		as_fn_error "\"you must use an unsigned numeric uid, not a name.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"you must use an unsigned numeric uid, not a name.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4745,13 +4751,13 @@ fi
 # Check whether --with-sudoers-gid was given.
 if test "${with_sudoers_gid+set}" = set; then :
   withval=$with_sudoers_gid; case $with_sudoers_gid in
-    yes)	as_fn_error "\"must give --with-sudoers-gid an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-sudoers-gid an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-sudoers-gid not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-sudoers-gid not supported.\"" "$LINENO" 5
 		;;
     [0-9]*)	SUDOERS_GID=$with_sudoers_gid
 		;;
-    *)		as_fn_error "\"you must use an unsigned numeric gid, not a name.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"you must use an unsigned numeric gid, not a name.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4763,13 +4769,13 @@ $as_echo_n "checking for umask programs
 # Check whether --with-umask was given.
 if test "${with_umask+set}" = set; then :
   withval=$with_umask; case $with_umask in
-    yes)	as_fn_error "\"must give --with-umask an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-umask an argument.\"" "$LINENO" 5
 		;;
     no)		sudo_umask=0777
 		;;
     [0-9]*)	sudo_umask=$with_umask
 		;;
-    *)		as_fn_error "\"you must enter a numeric mask.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"you must enter a numeric mask.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4793,9 +4799,9 @@ $as_echo_n "checking for default user to
 # Check whether --with-runas-default was given.
 if test "${with_runas_default+set}" = set; then :
   withval=$with_runas_default; case $with_runas_default in
-    yes)	as_fn_error "\"must give --with-runas-default an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-runas-default an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-runas-default not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-runas-default not supported.\"" "$LINENO" 5
 		;;
     *)		runas_default="$with_runas_default"
 		;;
@@ -4814,9 +4820,9 @@ $as_echo "$runas_default" >&6; }
 # Check whether --with-exempt was given.
 if test "${with_exempt+set}" = set; then :
   withval=$with_exempt; case $with_exempt in
-    yes)	as_fn_error "\"must give --with-exempt an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-exempt an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-exempt not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-exempt not supported.\"" "$LINENO" 5
 		;;
     *)
 cat >>confdefs.h <<_ACEOF
@@ -4838,9 +4844,9 @@ $as_echo_n "checking for editor that vis
 # Check whether --with-editor was given.
 if test "${with_editor+set}" = set; then :
   withval=$with_editor; case $with_editor in
-    yes)	as_fn_error "\"must give --with-editor an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"must give --with-editor an argument.\"" "$LINENO" 5
 		;;
-    no)		as_fn_error "\"--without-editor not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-editor not supported.\"" "$LINENO" 5
 		;;
     *)
 cat >>confdefs.h <<_ACEOF
@@ -4869,7 +4875,7 @@ if test "${with_env_editor+set}" = set;
 		;;
     no)		env_editor=off
 		;;
-    *)		as_fn_error "\"--with-env-editor does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-env-editor does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4891,11 +4897,11 @@ $as_echo_n "checking number of tries a u
 if test "${with_passwd_tries+set}" = set; then :
   withval=$with_passwd_tries; case $with_passwd_tries in
     yes)	;;
-    no)		as_fn_error "\"--without-editor not supported.\"" "$LINENO" 5
+    no)		as_fn_error $? "\"--without-editor not supported.\"" "$LINENO" 5
 		;;
     [1-9]*)	passwd_tries=$with_passwd_tries
 		;;
-    *)		as_fn_error "\"you must enter the numer of tries, > 0\"" "$LINENO" 5
+    *)		as_fn_error $? "\"you must enter the numer of tries, > 0\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4919,7 +4925,7 @@ if test "${with_timeout+set}" = set; the
 		;;
     [0-9]*)	timeout=$with_timeout
 		;;
-    *)		as_fn_error "\"you must enter the numer of minutes.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"you must enter the numer of minutes.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4943,7 +4949,7 @@ if test "${with_password_timeout+set}" =
 		;;
     [0-9]*)	password_timeout=$with_password_timeout
 		;;
-    *)		as_fn_error "\"you must enter the numer of minutes.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"you must enter the numer of minutes.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4966,7 +4972,7 @@ if test "${with_tty_tickets+set}" = set;
 		;;
     no)		tty_tickets=off
 		;;
-    *)		as_fn_error "\"--with-tty-tickets does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-tty-tickets does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -4997,7 +5003,7 @@ if test "${with_insults+set}" = set; the
 		;;
     no)		insults=off
 		;;
-    *)		as_fn_error "\"--with-insults does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-insults does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -5022,7 +5028,7 @@ if test "${with_all_insults+set}" = set;
 		with_goons_insults=yes
 		;;
     no)		;;
-    *)		as_fn_error "\"--with-all-insults does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-all-insults does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -5036,7 +5042,7 @@ if test "${with_classic_insults+set}" =
 
 		;;
     no)		;;
-    *)		as_fn_error "\"--with-classic-insults does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-classic-insults does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -5050,7 +5056,7 @@ if test "${with_csops_insults+set}" = se
 
 		;;
     no)		;;
-    *)		as_fn_error "\"--with-csops-insults does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-csops-insults does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -5064,7 +5070,7 @@ if test "${with_hal_insults+set}" = set;
 
 		;;
     no)		;;
-    *)		as_fn_error "\"--with-hal-insults does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-hal-insults does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -5078,7 +5084,7 @@ if test "${with_goons_insults+set}" = se
 
 		;;
     no)		;;
-    *)		as_fn_error "\"--with-goons-insults does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-goons-insults does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -5144,7 +5150,7 @@ if test "${with_pc_insults+set}" = set;
 
 		;;
     no)		;;
-    *)		as_fn_error "\"--with-pc-insults does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-pc-insults does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -5209,7 +5215,7 @@ $as_echo "yes" >&6; }
 		{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
 $as_echo "no" >&6; }
 		;;
-    *)		as_fn_error "\"--with-interfaces does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-interfaces does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 else
@@ -5232,7 +5238,7 @@ $as_echo "yes" >&6; }
     no)		{ $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
 $as_echo "no" >&6; }
 		;;
-    *)		as_fn_error "\"--with-stow does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-stow does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 else
@@ -5247,7 +5253,7 @@ $as_echo_n "checking whether to use an a
 # Check whether --with-askpass was given.
 if test "${with_askpass+set}" = set; then :
   withval=$with_askpass; case $with_askpass in
-    yes)	as_fn_error "\"--with-askpass takes a path as an argument.\"" "$LINENO" 5
+    yes)	as_fn_error $? "\"--with-askpass takes a path as an argument.\"" "$LINENO" 5
 		;;
     no)		;;
     *)		cat >>confdefs.h <<EOF
@@ -5451,7 +5457,7 @@ $as_echo "yes" >&6; }
 $as_echo "no" >&6; }
 		root_sudo=off
 		;;
-    *)		as_fn_error "\"--enable-root-sudo does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--enable-root-sudo does not take an argument.\"" "$LINENO" 5
 		;;
   esac
 
@@ -5677,7 +5683,7 @@ fi
 
 		;;
     no)		;;
-    *)		as_fn_error "\"--with-selinux does not take an argument.\"" "$LINENO" 5
+    *)		as_fn_error $? "\"--with-selinux does not take an argument.\"" "$LINENO" 5
 		;;
 esac
 fi
@@ -5789,7 +5795,7 @@ else
   # Broken: fails on valid input.
 continue
 fi
-rm -f conftest.err conftest.$ac_ext
+rm -f conftest.err conftest.i conftest.$ac_ext
 
   # OK, works on sane cases.  Now check whether nonexistent headers
   # can be detected and how.
@@ -5805,11 +5811,11 @@ else
 ac_preproc_ok=:
 break
 fi
-rm -f conftest.err conftest.$ac_ext
+rm -f conftest.err conftest.i conftest.$ac_ext
 
 done
 # Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
-rm -f conftest.err conftest.$ac_ext
+rm -f conftest.i conftest.err conftest.$ac_ext
 if $ac_preproc_ok; then :
   break
 fi
@@ -5848,7 +5854,7 @@ else
   # Broken: fails on valid input.
 continue
 fi
-rm -f conftest.err conftest.$ac_ext
+rm -f conftest.err conftest.i conftest.$ac_ext
 
   # OK, works on sane cases.  Now check whether nonexistent headers
   # can be detected and how.
@@ -5864,18 +5870,18 @@ else
 ac_preproc_ok=:
 break
 fi
-rm -f conftest.err conftest.$ac_ext
+rm -f conftest.err conftest.i conftest.$ac_ext
 
 done
 # Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
-rm -f conftest.err conftest.$ac_ext
+rm -f conftest.i conftest.err conftest.$ac_ext
 if $ac_preproc_ok; then :
 
 else
   { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
 $as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error "C preprocessor \"$CPP\" fails sanity check
-See \`config.log' for more details." "$LINENO" 5; }
+as_fn_error $? "C preprocessor \"$CPP\" fails sanity check
+See \`config.log' for more details" "$LINENO" 5 ; }
 fi
 
 ac_ext=c
@@ -6071,16 +6077,22 @@ fi
 
 ac_aux_dir=
 for ac_dir in "$srcdir" "$srcdir/.." "$srcdir/../.."; do
-  for ac_t in install-sh install.sh shtool; do
-    if test -f "$ac_dir/$ac_t"; then
-      ac_aux_dir=$ac_dir
-      ac_install_sh="$ac_aux_dir/$ac_t -c"
-      break 2
-    fi
-  done
+  if test -f "$ac_dir/install-sh"; then
+    ac_aux_dir=$ac_dir
+    ac_install_sh="$ac_aux_dir/install-sh -c"
+    break
+  elif test -f "$ac_dir/install.sh"; then
+    ac_aux_dir=$ac_dir
+    ac_install_sh="$ac_aux_dir/install.sh -c"
+    break
+  elif test -f "$ac_dir/shtool"; then
+    ac_aux_dir=$ac_dir
+    ac_install_sh="$ac_aux_dir/shtool install -c"
+    break
+  fi
 done
 if test -z "$ac_aux_dir"; then
-  as_fn_error "cannot find install-sh, install.sh, or shtool in \"$srcdir\" \"$srcdir/..\" \"$srcdir/../..\"" "$LINENO" 5
+  as_fn_error $? "cannot find install-sh, install.sh, or shtool in \"$srcdir\" \"$srcdir/..\" \"$srcdir/../..\"" "$LINENO" 5
 fi
 
 # These three variables are undocumented and unsupported,
@@ -6094,7 +6106,7 @@ ac_configure="$SHELL $ac_aux_dir/configu
 
 # Make sure we can run config.sub.
 $SHELL "$ac_aux_dir/config.sub" sun4 >/dev/null 2>&1 ||
-  as_fn_error "cannot run $SHELL $ac_aux_dir/config.sub" "$LINENO" 5
+  as_fn_error $? "cannot run $SHELL $ac_aux_dir/config.sub" "$LINENO" 5
 
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking build system type" >&5
 $as_echo_n "checking build system type... " >&6; }
@@ -6105,16 +6117,16 @@ else
 test "x$ac_build_alias" = x &&
   ac_build_alias=`$SHELL "$ac_aux_dir/config.guess"`
 test "x$ac_build_alias" = x &&
-  as_fn_error "cannot guess build type; you must specify one" "$LINENO" 5
+  as_fn_error $? "cannot guess build type; you must specify one" "$LINENO" 5
 ac_cv_build=`$SHELL "$ac_aux_dir/config.sub" $ac_build_alias` ||
-  as_fn_error "$SHELL $ac_aux_dir/config.sub $ac_build_alias failed" "$LINENO" 5
+  as_fn_error $? "$SHELL $ac_aux_dir/config.sub $ac_build_alias failed" "$LINENO" 5
 
 fi
 { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_build" >&5
 $as_echo "$ac_cv_build" >&6; }
 case $ac_cv_build in
 *-*-*) ;;
-*) as_fn_error "invalid value of canonical build" "$LINENO" 5;;
+*) as_fn_error $? "invalid value of canonical build" "$LINENO" 5 ;;
 esac
 build=$ac_cv_build
 ac_save_IFS=$IFS; IFS='-'
@@ -6139,7 +6151,7 @@ else
   ac_cv_host=$ac_cv_build
 else
   ac_cv_host=`$SHELL "$ac_aux_dir/config.sub" $host_alias` ||
-    as_fn_error "$SHELL $ac_aux_dir/config.sub $host_alias failed" "$LINENO" 5
+    as_fn_error $? "$SHELL $ac_aux_dir/config.sub $host_alias failed" "$LINENO" 5
 fi
 
 fi
@@ -6147,7 +6159,7 @@ fi
 $as_echo "$ac_cv_host" >&6; }
 case $ac_cv_host in
 *-*-*) ;;
-*) as_fn_error "invalid value of canonical host" "$LINENO" 5;;
+*) as_fn_error $? "invalid value of canonical host" "$LINENO" 5 ;;
 esac
 host=$ac_cv_host
 ac_save_IFS=$IFS; IFS='-'
@@ -6247,7 +6259,7 @@ esac
   done
 IFS=$as_save_IFS
   if test -z "$ac_cv_path_SED"; then
-    as_fn_error "no acceptable sed could be found in \$PATH" "$LINENO" 5
+    as_fn_error $? "no acceptable sed could be found in \$PATH" "$LINENO" 5
   fi
 else
   ac_cv_path_SED=$SED
@@ -6323,7 +6335,7 @@ esac
   done
 IFS=$as_save_IFS
   if test -z "$ac_cv_path_GREP"; then
-    as_fn_error "no acceptable grep could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" "$LINENO" 5
+    as_fn_error $? "no acceptable grep could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" "$LINENO" 5
   fi
 else
   ac_cv_path_GREP=$GREP
@@ -6389,7 +6401,7 @@ esac
   done
 IFS=$as_save_IFS
   if test -z "$ac_cv_path_EGREP"; then
-    as_fn_error "no acceptable egrep could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" "$LINENO" 5
+    as_fn_error $? "no acceptable egrep could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" "$LINENO" 5
   fi
 else
   ac_cv_path_EGREP=$EGREP
@@ -6456,7 +6468,7 @@ esac
   done
 IFS=$as_save_IFS
   if test -z "$ac_cv_path_FGREP"; then
-    as_fn_error "no acceptable fgrep could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" "$LINENO" 5
+    as_fn_error $? "no acceptable fgrep could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" "$LINENO" 5
   fi
 else
   ac_cv_path_FGREP=$FGREP
@@ -6572,7 +6584,7 @@ else
   { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
 $as_echo "no" >&6; }
 fi
-test -z "$LD" && as_fn_error "no acceptable ld found in \$PATH" "$LINENO" 5
+test -z "$LD" && as_fn_error $? "no acceptable ld found in \$PATH" "$LINENO" 5
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking if the linker ($LD) is GNU ld" >&5
 $as_echo_n "checking if the linker ($LD) is GNU ld... " >&6; }
 if test "${lt_cv_prog_gnu_ld+set}" = set; then :
@@ -6774,13 +6786,13 @@ if test "${lt_cv_nm_interface+set}" = se
 else
   lt_cv_nm_interface="BSD nm"
   echo "int some_variable = 0;" > conftest.$ac_ext
-  (eval echo "\"\$as_me:6765: $ac_compile\"" >&5)
+  (eval echo "\"\$as_me:6789: $ac_compile\"" >&5)
   (eval "$ac_compile" 2>conftest.err)
   cat conftest.err >&5
-  (eval echo "\"\$as_me:6768: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
+  (eval echo "\"\$as_me:6792: $NM \\\"conftest.$ac_objext\\\"\"" >&5)
   (eval "$NM \"conftest.$ac_objext\"" 2>conftest.err > conftest.out)
   cat conftest.err >&5
-  (eval echo "\"\$as_me:6771: output\"" >&5)
+  (eval echo "\"\$as_me:6795: output\"" >&5)
   cat conftest.out >&5
   if $GREP 'External.*some_variable' conftest.out > /dev/null; then
     lt_cv_nm_interface="MS dumpbin"
@@ -7985,7 +7997,7 @@ ia64-*-hpux*)
   ;;
 *-*-irix6*)
   # Find out which ABI we are using.
-  echo '#line 7976 "configure"' > conftest.$ac_ext
+  echo '#line 8000 "configure"' > conftest.$ac_ext
   if { { eval echo "\"\$as_me\":${as_lineno-$LINENO}: \"$ac_compile\""; } >&5
   (eval $ac_compile) 2>&5
   ac_status=$?
@@ -8852,8 +8864,7 @@ do :
   as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
 ac_fn_c_check_header_compile "$LINENO" "$ac_header" "$as_ac_Header" "$ac_includes_default
 "
-eval as_val=\$$as_ac_Header
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
@@ -9378,11 +9389,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:9369: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:9392: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:9373: \$? = $ac_status" >&5
+   echo "$as_me:9396: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -9717,11 +9728,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:9708: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:9731: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>conftest.err)
    ac_status=$?
    cat conftest.err >&5
-   echo "$as_me:9712: \$? = $ac_status" >&5
+   echo "$as_me:9735: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s "$ac_outfile"; then
      # The compiler can only warn and ignore the option if not recognized
      # So say no if there are warnings other than the usual output.
@@ -9822,11 +9833,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:9813: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:9836: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:9817: \$? = $ac_status" >&5
+   echo "$as_me:9840: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -9877,11 +9888,11 @@ else
    -e 's:.*FLAGS}\{0,1\} :&$lt_compiler_flag :; t' \
    -e 's: [^ ]*conftest\.: $lt_compiler_flag&:; t' \
    -e 's:$: $lt_compiler_flag:'`
-   (eval echo "\"\$as_me:9868: $lt_compile\"" >&5)
+   (eval echo "\"\$as_me:9891: $lt_compile\"" >&5)
    (eval "$lt_compile" 2>out/conftest.err)
    ac_status=$?
    cat out/conftest.err >&5
-   echo "$as_me:9872: \$? = $ac_status" >&5
+   echo "$as_me:9895: \$? = $ac_status" >&5
    if (exit $ac_status) && test -s out/conftest2.$ac_objext
    then
      # The compiler can only warn and ignore the option if not recognized
@@ -12244,7 +12255,7 @@ else
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<_LT_EOF
-#line 12235 "configure"
+#line 12258 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -12340,7 +12351,7 @@ else
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<_LT_EOF
-#line 12331 "configure"
+#line 12354 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -12720,7 +12731,7 @@ fi
 
 if test -n "$sudo_cv_prev_host"; then
     if test "$sudo_cv_prev_host" != "$host"; then
-	as_fn_error "config.cache was created on a different host; remove it and re-run configure." "$LINENO" 5
+	as_fn_error $? "config.cache was created on a different host; remove it and re-run configure." "$LINENO" 5
     else
 	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking previous host type" >&5
 $as_echo_n "checking previous host type... " >&6; }
@@ -12854,8 +12865,7 @@ fi
 do :
   as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
 ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
-eval as_val=\$$as_ac_var
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
@@ -13331,14 +13341,14 @@ AUTH_EXCL=${AUTH_EXCL# }
 if test -n "$AUTH_EXCL"; then
     set -- $AUTH_EXCL
     if test $# != 1; then
-	as_fn_error "More than one mutually exclusive authentication method specified: $AUTH_EXCL" "$LINENO" 5
+	as_fn_error $? "More than one mutually exclusive authentication method specified: $AUTH_EXCL" "$LINENO" 5
     fi
     if test -n "$AUTH_REG"; then
-	as_fn_error "Cannot mix mutually exclusive ($AUTH_EXCL) and regular ($AUTH_REG) authentication methods" "$LINENO" 5
+	as_fn_error $? "Cannot mix mutually exclusive ($AUTH_EXCL) and regular ($AUTH_REG) authentication methods" "$LINENO" 5
     fi
 fi
 if test X"${with_skey}${with_opie}" = X"yesyes"; then
-    as_fn_error "\"cannot use both S/Key and OPIE\"" "$LINENO" 5
+    as_fn_error $? "\"cannot use both S/Key and OPIE\"" "$LINENO" 5
 fi
 
 : ${mansectsu='8'}
@@ -13842,7 +13852,7 @@ for ac_hdr in dirent.h sys/ndir.h sys/di
   as_ac_Header=`$as_echo "ac_cv_header_dirent_$ac_hdr" | $as_tr_sh`
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_hdr that defines DIR" >&5
 $as_echo_n "checking for $ac_hdr that defines DIR... " >&6; }
-if { as_var=$as_ac_Header; eval "test \"\${$as_var+set}\" = set"; }; then :
+if eval "test \"\${$as_ac_Header+set}\"" = set; then :
   $as_echo_n "(cached) " >&6
 else
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
@@ -13869,8 +13879,7 @@ fi
 eval ac_res=\$$as_ac_Header
 	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
 $as_echo "$ac_res" >&6; }
-eval as_val=\$$as_ac_Header
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_hdr" | $as_tr_cpp` 1
 _ACEOF
@@ -14035,8 +14044,7 @@ for ac_header in malloc.h paths.h utime.
 do :
   as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
 ac_fn_c_check_header_mongrel "$LINENO" "$ac_header" "$as_ac_Header" "$ac_includes_default"
-eval as_val=\$$as_ac_Header
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
@@ -14395,9 +14403,8 @@ else
   if test "$ac_cv_type_long_int" = yes; then
      { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
 $as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
-{ as_fn_set_status 77
-as_fn_error "cannot compute sizeof (long int)
-See \`config.log' for more details." "$LINENO" 5; }; }
+as_fn_error 77 "cannot compute sizeof (long int)
+See \`config.log' for more details" "$LINENO" 5 ; }
    else
      ac_cv_sizeof_long_int=0
    fi
@@ -14825,12 +14832,11 @@ LIBS=$ac_save_LIBS
 for ac_func in strchr strrchr memchr memcpy memset sysconf tzset \
 	       strftime setrlimit initgroups getgroups fstat gettimeofday \
 	       regcomp setlocale getaddrinfo getsid setenv vhangup \
-	       mbr_check_membership setrlimit64
+	       mbr_check_membership setrlimit64 openat
 do :
   as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
 ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
-eval as_val=\$$as_ac_var
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
@@ -14891,7 +14897,7 @@ if test "${ac_cv_func_setpgrp_void+set}"
   $as_echo_n "(cached) " >&6
 else
   if test "$cross_compiling" = yes; then :
-  as_fn_error "cannot check setpgrp when cross compiling" "$LINENO" 5
+  as_fn_error $? "cannot check setpgrp when cross compiling" "$LINENO" 5
 else
   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
@@ -14934,8 +14940,7 @@ for ac_func in sysctl getutid getutxid
 do :
   as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
 ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
-eval as_val=\$$as_ac_var
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
@@ -14955,8 +14960,7 @@ _ACEOF
 do :
   as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
 ac_fn_c_check_header_mongrel "$LINENO" "$ac_header" "$as_ac_Header" "$ac_includes_default"
-eval as_val=\$$as_ac_Header
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
@@ -15009,8 +15013,7 @@ if test "x$ac_cv_lib_util_openpty" = x""
 do :
   as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
 ac_fn_c_check_header_mongrel "$LINENO" "$ac_header" "$as_ac_Header" "$ac_includes_default"
-eval as_val=\$$as_ac_Header
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
@@ -15231,23 +15234,18 @@ done
 
 fi
 if test -z "$BROKEN_GETCWD"; then
-    for ac_func in getcwd
-do :
-  ac_fn_c_check_func "$LINENO" "getcwd" "ac_cv_func_getcwd"
+    ac_fn_c_check_func "$LINENO" "getcwd" "ac_cv_func_getcwd"
 if test "x$ac_cv_func_getcwd" = x""yes; then :
-  cat >>confdefs.h <<_ACEOF
-#define HAVE_GETCWD 1
-_ACEOF
+  $as_echo "#define HAVE_GETCWD 1" >>confdefs.h
 
 else
   case " $LIBOBJS " in
-  *" $ac_func.$ac_objext "* ) ;;
-  *) LIBOBJS="$LIBOBJS $ac_func.$ac_objext"
+  *" getcwd.$ac_objext "* ) ;;
+  *) LIBOBJS="$LIBOBJS getcwd.$ac_objext"
  ;;
 esac
 
 fi
-done
 
 
 fi
@@ -15301,8 +15299,7 @@ for ac_func in lockf flock
 do :
   as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
 ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
-eval as_val=\$$as_ac_var
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
@@ -15314,8 +15311,7 @@ for ac_func in waitpid wait3
 do :
   as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
 ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
-eval as_val=\$$as_ac_var
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
@@ -15327,8 +15323,7 @@ for ac_func in innetgr _innetgr
 do :
   as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
 ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
-eval as_val=\$$as_ac_var
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
@@ -15357,8 +15352,7 @@ _ACEOF
 do :
   as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
 ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
-eval as_val=\$$as_ac_var
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
@@ -15483,25 +15477,83 @@ esac
 
   fi
 
-for ac_func in memrchr strerror strcasecmp sigaction strlcpy strlcat
-do :
-  as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
-ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
-eval as_val=\$$as_ac_var
-   if test "x$as_val" = x""yes; then :
-  cat >>confdefs.h <<_ACEOF
-#define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
-_ACEOF
+ac_fn_c_check_func "$LINENO" "memrchr" "ac_cv_func_memrchr"
+if test "x$ac_cv_func_memrchr" = x""yes; then :
+  $as_echo "#define HAVE_MEMRCHR 1" >>confdefs.h
 
 else
   case " $LIBOBJS " in
-  *" $ac_func.$ac_objext "* ) ;;
-  *) LIBOBJS="$LIBOBJS $ac_func.$ac_objext"
+  *" memrchr.$ac_objext "* ) ;;
+  *) LIBOBJS="$LIBOBJS memrchr.$ac_objext"
+ ;;
+esac
+
+fi
+
+ac_fn_c_check_func "$LINENO" "strerror" "ac_cv_func_strerror"
+if test "x$ac_cv_func_strerror" = x""yes; then :
+  $as_echo "#define HAVE_STRERROR 1" >>confdefs.h
+
+else
+  case " $LIBOBJS " in
+  *" strerror.$ac_objext "* ) ;;
+  *) LIBOBJS="$LIBOBJS strerror.$ac_objext"
+ ;;
+esac
+
+fi
+
+ac_fn_c_check_func "$LINENO" "strcasecmp" "ac_cv_func_strcasecmp"
+if test "x$ac_cv_func_strcasecmp" = x""yes; then :
+  $as_echo "#define HAVE_STRCASECMP 1" >>confdefs.h
+
+else
+  case " $LIBOBJS " in
+  *" strcasecmp.$ac_objext "* ) ;;
+  *) LIBOBJS="$LIBOBJS strcasecmp.$ac_objext"
+ ;;
+esac
+
+fi
+
+ac_fn_c_check_func "$LINENO" "sigaction" "ac_cv_func_sigaction"
+if test "x$ac_cv_func_sigaction" = x""yes; then :
+  $as_echo "#define HAVE_SIGACTION 1" >>confdefs.h
+
+else
+  case " $LIBOBJS " in
+  *" sigaction.$ac_objext "* ) ;;
+  *) LIBOBJS="$LIBOBJS sigaction.$ac_objext"
+ ;;
+esac
+
+fi
+
+ac_fn_c_check_func "$LINENO" "strlcpy" "ac_cv_func_strlcpy"
+if test "x$ac_cv_func_strlcpy" = x""yes; then :
+  $as_echo "#define HAVE_STRLCPY 1" >>confdefs.h
+
+else
+  case " $LIBOBJS " in
+  *" strlcpy.$ac_objext "* ) ;;
+  *) LIBOBJS="$LIBOBJS strlcpy.$ac_objext"
+ ;;
+esac
+
+fi
+
+ac_fn_c_check_func "$LINENO" "strlcat" "ac_cv_func_strlcat"
+if test "x$ac_cv_func_strlcat" = x""yes; then :
+  $as_echo "#define HAVE_STRLCAT 1" >>confdefs.h
+
+else
+  case " $LIBOBJS " in
+  *" strlcat.$ac_objext "* ) ;;
+  *) LIBOBJS="$LIBOBJS strlcat.$ac_objext"
  ;;
 esac
 
 fi
-done
 
 
 for ac_func in nanosleep
@@ -15607,8 +15659,7 @@ else
 do :
   as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
 ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
-eval as_val=\$$as_ac_var
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
@@ -15624,8 +15675,7 @@ for ac_func in snprintf vsnprintf asprin
 do :
   as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
 ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
-eval as_val=\$$as_ac_var
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
@@ -15787,7 +15837,7 @@ else
 $as_echo "$as_me: WARNING: unable to find socket() trying -lsocket -lnsl" >&2;}
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking for socket in -lsocket" >&5
 $as_echo_n "checking for socket in -lsocket... " >&6; }
-if test "${ac_cv_lib_socket_socket_lnsl+set}" = set; then :
+if test "${ac_cv_lib_socket_socket+set}" = set; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
@@ -15811,17 +15861,17 @@ return socket ();
 }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_lib_socket_socket_lnsl=yes
+  ac_cv_lib_socket_socket=yes
 else
-  ac_cv_lib_socket_socket_lnsl=no
+  ac_cv_lib_socket_socket=no
 fi
 rm -f core conftest.err conftest.$ac_objext \
     conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_socket_socket_lnsl" >&5
-$as_echo "$ac_cv_lib_socket_socket_lnsl" >&6; }
-if test "x$ac_cv_lib_socket_socket_lnsl" = x""yes; then :
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_socket_socket" >&5
+$as_echo "$ac_cv_lib_socket_socket" >&6; }
+if test "x$ac_cv_lib_socket_socket" = x""yes; then :
   NET_LIBS="${NET_LIBS} -lsocket -lnsl"; LIBS="${LIBS} -lsocket -lnsl"
 fi
 
@@ -15921,7 +15971,7 @@ else
 $as_echo "$as_me: WARNING: unable to find inet_addr() trying -lsocket -lnsl" >&2;}
 { $as_echo "$as_me:${as_lineno-$LINENO}: checking for inet_addr in -lsocket" >&5
 $as_echo_n "checking for inet_addr in -lsocket... " >&6; }
-if test "${ac_cv_lib_socket_inet_addr_lnsl+set}" = set; then :
+if test "${ac_cv_lib_socket_inet_addr+set}" = set; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
@@ -15945,17 +15995,17 @@ return inet_addr ();
 }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_lib_socket_inet_addr_lnsl=yes
+  ac_cv_lib_socket_inet_addr=yes
 else
-  ac_cv_lib_socket_inet_addr_lnsl=no
+  ac_cv_lib_socket_inet_addr=no
 fi
 rm -f core conftest.err conftest.$ac_objext \
     conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_socket_inet_addr_lnsl" >&5
-$as_echo "$ac_cv_lib_socket_inet_addr_lnsl" >&6; }
-if test "x$ac_cv_lib_socket_inet_addr_lnsl" = x""yes; then :
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_socket_inet_addr" >&5
+$as_echo "$ac_cv_lib_socket_inet_addr" >&6; }
+if test "x$ac_cv_lib_socket_inet_addr" = x""yes; then :
   NET_LIBS="${NET_LIBS} -lsocket -lnsl"; LIBS="${LIBS} -lsocket -lnsl"
 fi
 
@@ -16314,8 +16364,7 @@ fi
 do :
   as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
 ac_fn_c_check_header_mongrel "$LINENO" "$ac_header" "$as_ac_Header" "$ac_includes_default"
-eval as_val=\$$as_ac_Header
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
@@ -16342,7 +16391,7 @@ $as_echo_n "checking whether to use PAM
 $as_echo "yes" >&6; }
 			;;
 	    no)		;;
-	    *)		as_fn_error "\"--with-pam-login does not take an argument.\"" "$LINENO" 5
+	    *)		as_fn_error $? "\"--with-pam-login does not take an argument.\"" "$LINENO" 5
 			;;
 	esac
 fi
@@ -16465,7 +16514,7 @@ if test "x$ac_cv_header_bsd_auth_h" = x"
 	BSDAUTH_USAGE='[-a auth_type] '
 	AUTH_EXCL=BSD_AUTH; BAMAN=1
 else
-  as_fn_error "BSD authentication was specified but bsd_auth.h could not be found" "$LINENO" 5
+  as_fn_error $? "BSD authentication was specified but bsd_auth.h could not be found" "$LINENO" 5
 fi
 
 
@@ -16545,7 +16594,7 @@ if test ${with_SecurID-'no'} != "no"; th
     #
     { $as_echo "$as_me:${as_lineno-$LINENO}: checking for SD_Init in -laceclnt" >&5
 $as_echo_n "checking for SD_Init in -laceclnt... " >&6; }
-if test "${ac_cv_lib_aceclnt_SD_Init_______lpthread_______+set}" = set; then :
+if test "${ac_cv_lib_aceclnt_SD_Init+set}" = set; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
@@ -16572,17 +16621,17 @@ return SD_Init ();
 }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_lib_aceclnt_SD_Init_______lpthread_______=yes
+  ac_cv_lib_aceclnt_SD_Init=yes
 else
-  ac_cv_lib_aceclnt_SD_Init_______lpthread_______=no
+  ac_cv_lib_aceclnt_SD_Init=no
 fi
 rm -f core conftest.err conftest.$ac_objext \
     conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_aceclnt_SD_Init_______lpthread_______" >&5
-$as_echo "$ac_cv_lib_aceclnt_SD_Init_______lpthread_______" >&6; }
-if test "x$ac_cv_lib_aceclnt_SD_Init_______lpthread_______" = x""yes; then :
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_aceclnt_SD_Init" >&5
+$as_echo "$ac_cv_lib_aceclnt_SD_Init" >&6; }
+if test "x$ac_cv_lib_aceclnt_SD_Init" = x""yes; then :
 
 	    AUTH_OBJS="$AUTH_OBJS securid5.o";
 	    SUDO_LIBS="${SUDO_LIBS} -laceclnt -lpthread"
@@ -16639,7 +16688,7 @@ _ACEOF
 if ac_fn_c_try_cpp "$LINENO"; then :
   found=yes; break
 fi
-rm -f conftest.err conftest.$ac_ext
+rm -f conftest.err conftest.i conftest.$ac_ext
 	done
 	test X"$found" = X"no" && CPPFLAGS="$O_CPPFLAGS"
     else
@@ -16834,10 +16883,9 @@ $as_echo "no" >&6; }
 
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
-                as_ac_Lib=`$as_echo "ac_cv_lib_krb_main$K4LIBS" | $as_tr_sh`
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for main in -lkrb" >&5
+                { $as_echo "$as_me:${as_lineno-$LINENO}: checking for main in -lkrb" >&5
 $as_echo_n "checking for main in -lkrb... " >&6; }
-if { as_var=$as_ac_Lib; eval "test \"\${$as_var+set}\" = set"; }; then :
+if test "${ac_cv_lib_krb_main+set}" = set; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
@@ -16855,26 +16903,23 @@ return main ();
 }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"; then :
-  eval "$as_ac_Lib=yes"
+  ac_cv_lib_krb_main=yes
 else
-  eval "$as_ac_Lib=no"
+  ac_cv_lib_krb_main=no
 fi
 rm -f core conftest.err conftest.$ac_objext \
     conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-eval ac_res=\$$as_ac_Lib
-	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
-$as_echo "$ac_res" >&6; }
-eval as_val=\$$as_ac_Lib
-   if test "x$as_val" = x""yes; then :
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_krb_main" >&5
+$as_echo "$ac_cv_lib_krb_main" >&6; }
+if test "x$ac_cv_lib_krb_main" = x""yes; then :
   K4LIBS="-lkrb $K4LIBS"
 else
 
-	as_ac_Lib=`$as_echo "ac_cv_lib_krb4_main$K4LIBS" | $as_tr_sh`
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for main in -lkrb4" >&5
+	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for main in -lkrb4" >&5
 $as_echo_n "checking for main in -lkrb4... " >&6; }
-if { as_var=$as_ac_Lib; eval "test \"\${$as_var+set}\" = set"; }; then :
+if test "${ac_cv_lib_krb4_main+set}" = set; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
@@ -16892,19 +16937,17 @@ return main ();
 }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"; then :
-  eval "$as_ac_Lib=yes"
+  ac_cv_lib_krb4_main=yes
 else
-  eval "$as_ac_Lib=no"
+  ac_cv_lib_krb4_main=no
 fi
 rm -f core conftest.err conftest.$ac_objext \
     conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-eval ac_res=\$$as_ac_Lib
-	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
-$as_echo "$ac_res" >&6; }
-eval as_val=\$$as_ac_Lib
-   if test "x$as_val" = x""yes; then :
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_krb4_main" >&5
+$as_echo "$ac_cv_lib_krb4_main" >&6; }
+if test "x$ac_cv_lib_krb4_main" = x""yes; then :
   K4LIBS="-lkrb4 $K4LIBS"
 else
   K4LIBS="-lkrb $K4LIBS"
@@ -17011,7 +17054,7 @@ _ACEOF
 if ac_fn_c_try_cpp "$LINENO"; then :
   found=yes; break
 fi
-rm -f conftest.err conftest.$ac_ext
+rm -f conftest.err conftest.i conftest.$ac_ext
 	done
 	if test X"$found" = X"no"; then
 	    CPPFLAGS="$O_CPPFLAGS"
@@ -17142,8 +17185,7 @@ rm -f core conftest.err conftest.$ac_obj
 do :
   as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
 ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
-eval as_val=\$$as_ac_var
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
@@ -17309,7 +17351,7 @@ if ac_fn_c_try_cpp "$LINENO"; then :
 else
   found=no
 fi
-rm -f conftest.err conftest.$ac_ext
+rm -f conftest.err conftest.i conftest.$ac_ext
     else
 	found=no
 	O_CPPFLAGS="$CPPFLAGS"
@@ -17322,7 +17364,7 @@ _ACEOF
 if ac_fn_c_try_cpp "$LINENO"; then :
   found=yes; break
 fi
-rm -f conftest.err conftest.$ac_ext
+rm -f conftest.err conftest.i conftest.$ac_ext
 	done
 	if test "$found" = "no" -o -z "$dir"; then
 	    CPPFLAGS="$O_CPPFLAGS"
@@ -17489,7 +17531,7 @@ if ac_fn_c_try_cpp "$LINENO"; then :
 else
   found=no
 fi
-rm -f conftest.err conftest.$ac_ext
+rm -f conftest.err conftest.i conftest.$ac_ext
     else
 	found=no
 	O_CPPFLAGS="$CPPFLAGS"
@@ -17502,7 +17544,7 @@ _ACEOF
 if ac_fn_c_try_cpp "$LINENO"; then :
   found=yes; break
 fi
-rm -f conftest.err conftest.$ac_ext
+rm -f conftest.err conftest.i conftest.$ac_ext
 	done
 	if test "$found" = "no" -o -z "$dir"; then
 	    CPPFLAGS="$O_CPPFLAGS"
@@ -17653,8 +17695,7 @@ fi
 do :
   as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
 ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
-eval as_val=\$$as_ac_var
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
@@ -17670,8 +17711,7 @@ done
 do :
   as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
 ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
-eval as_val=\$$as_ac_var
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
@@ -17816,8 +17856,7 @@ fi
 do :
   as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
 ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
-eval as_val=\$$as_ac_var
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
@@ -17997,8 +18036,7 @@ rm -f core conftest.err conftest.$ac_obj
 do :
   as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
 ac_fn_c_check_header_mongrel "$LINENO" "$ac_header" "$as_ac_Header" "$ac_includes_default"
-eval as_val=\$$as_ac_Header
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
@@ -18024,8 +18062,7 @@ do :
   as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
 ac_fn_c_check_header_compile "$LINENO" "$ac_header" "$as_ac_Header" "#include <ldap.h>
 "
-eval as_val=\$$as_ac_Header
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
@@ -18038,8 +18075,7 @@ done
 do :
   as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
 ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
-eval as_val=\$$as_ac_var
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
 _ACEOF
@@ -18155,17 +18191,16 @@ _ACEOF
 if ac_fn_c_try_cpp "$LINENO"; then :
   found="gssapi.h"; break
 fi
-rm -f conftest.err conftest.$ac_ext
+rm -f conftest.err conftest.i conftest.$ac_ext
 fi
-rm -f conftest.err conftest.$ac_ext
+rm -f conftest.err conftest.i conftest.$ac_ext
 	done
 	if test X"$found" != X"no"; then
 	    for ac_header in $found
 do :
   as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
 ac_fn_c_check_header_mongrel "$LINENO" "$ac_header" "$as_ac_Header" "$ac_includes_default"
-eval as_val=\$$as_ac_Header
-   if test "x$as_val" = x""yes; then :
+if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
   cat >>confdefs.h <<_ACEOF
 #define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
 _ACEOF
@@ -18438,7 +18473,7 @@ yes|maybe)
     $as_echo "#define WITHOUT_PASSWD 1" >>confdefs.h
 
     if test -z "$AUTH_OBJS"; then
-	as_fn_error "no authentication methods defined." "$LINENO" 5
+	as_fn_error $? "no authentication methods defined." "$LINENO" 5
     fi
     ;;
 esac
@@ -18588,6 +18623,7 @@ DEFS=-DHAVE_CONFIG_H
 
 ac_libobjs=
 ac_ltlibobjs=
+U=
 for ac_i in : $LIBOBJS; do test "x$ac_i" = x: && continue
   # 1. Remove the extension, and $U if already installed.
   ac_script='s/\$U\././;s/\.o$//;s/\.obj$//'
@@ -18749,19 +18785,19 @@ export LANGUAGE
 (unset CDPATH) >/dev/null 2>&1 && unset CDPATH
 
 
-# as_fn_error ERROR [LINENO LOG_FD]
-# ---------------------------------
+# as_fn_error STATUS ERROR [LINENO LOG_FD]
+# ----------------------------------------
 # Output "`basename $0`: error: ERROR" to stderr. If LINENO and LOG_FD are
 # provided, also output the error to LOG_FD, referencing LINENO. Then exit the
-# script with status $?, using 1 if that was 0.
+# script with STATUS, using 1 if that was 0.
 as_fn_error ()
 {
-  as_status=$?; test $as_status -eq 0 && as_status=1
-  if test "$3"; then
-    as_lineno=${as_lineno-"$2"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
-    $as_echo "$as_me:${as_lineno-$LINENO}: error: $1" >&$3
+  as_status=$1; test $as_status -eq 0 && as_status=1
+  if test "$4"; then
+    as_lineno=${as_lineno-"$3"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+    $as_echo "$as_me:${as_lineno-$LINENO}: error: $2" >&$4
   fi
-  $as_echo "$as_me: error: $1" >&2
+  $as_echo "$as_me: error: $2" >&2
   as_fn_exit $as_status
 } # as_fn_error
 
@@ -18957,7 +18993,7 @@ $as_echo X"$as_dir" |
       test -d "$as_dir" && break
     done
     test -z "$as_dirs" || eval "mkdir $as_dirs"
-  } || test -d "$as_dir" || as_fn_error "cannot create directory $as_dir"
+  } || test -d "$as_dir" || as_fn_error $? "cannot create directory $as_dir"
 
 
 } # as_fn_mkdir_p
@@ -19011,7 +19047,7 @@ cat >>$CONFIG_STATUS <<\_ACEOF || ac_wri
 # values after options handling.
 ac_log="
 This file was extended by sudo $as_me 1.7.4p4, which was
-generated by GNU Autoconf 2.65.  Invocation command line was
+generated by GNU Autoconf 2.67.  Invocation command line was
 
   CONFIG_FILES    = $CONFIG_FILES
   CONFIG_HEADERS  = $CONFIG_HEADERS
@@ -19077,10 +19113,10 @@ cat >>$CONFIG_STATUS <<_ACEOF || ac_writ
 ac_cs_config="`$as_echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`"
 ac_cs_version="\\
 sudo config.status 1.7.4p4
-configured by $0, generated by GNU Autoconf 2.65,
+configured by $0, generated by GNU Autoconf 2.67,
   with options \\"\$ac_cs_config\\"
 
-Copyright (C) 2009 Free Software Foundation, Inc.
+Copyright (C) 2010 Free Software Foundation, Inc.
 This config.status script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it."
 
@@ -19095,11 +19131,16 @@ ac_need_defaults=:
 while test $# != 0
 do
   case $1 in
-  --*=*)
+  --*=?*)
     ac_option=`expr "X$1" : 'X\([^=]*\)='`
     ac_optarg=`expr "X$1" : 'X[^=]*=\(.*\)'`
     ac_shift=:
     ;;
+  --*=)
+    ac_option=`expr "X$1" : 'X\([^=]*\)='`
+    ac_optarg=
+    ac_shift=:
+    ;;
   *)
     ac_option=$1
     ac_optarg=$2
@@ -19121,6 +19162,7 @@ do
     $ac_shift
     case $ac_optarg in
     *\'*) ac_optarg=`$as_echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"` ;;
+    '') as_fn_error $? "missing file argument" ;;
     esac
     as_fn_append CONFIG_FILES " '$ac_optarg'"
     ac_need_defaults=false;;
@@ -19133,7 +19175,7 @@ do
     ac_need_defaults=false;;
   --he | --h)
     # Conflict between --help and --header
-    as_fn_error "ambiguous option: \`$1'
+    as_fn_error $? "ambiguous option: \`$1'
 Try \`$0 --help' for more information.";;
   --help | --hel | -h )
     $as_echo "$ac_cs_usage"; exit ;;
@@ -19142,7 +19184,7 @@ Try \`$0 --help' for more information.";
     ac_cs_silent=: ;;
 
   # This is an error.
-  -*) as_fn_error "unrecognized option: \`$1'
+  -*) as_fn_error $? "unrecognized option: \`$1'
 Try \`$0 --help' for more information." ;;
 
   *) as_fn_append ac_config_targets " $1"
@@ -19462,7 +19504,7 @@ do
     "sudo_usage.h") CONFIG_FILES="$CONFIG_FILES sudo_usage.h" ;;
     "sudoers") CONFIG_FILES="$CONFIG_FILES sudoers" ;;
 
-  *) as_fn_error "invalid argument: \`$ac_config_target'" "$LINENO" 5;;
+  *) as_fn_error $? "invalid argument: \`$ac_config_target'" "$LINENO" 5 ;;
   esac
 done
 
@@ -19500,7 +19542,7 @@ $debug ||
 {
   tmp=./conf$$-$RANDOM
   (umask 077 && mkdir "$tmp")
-} || as_fn_error "cannot create a temporary directory in ." "$LINENO" 5
+} || as_fn_error $? "cannot create a temporary directory in ." "$LINENO" 5
 
 # Set up the scripts for CONFIG_FILES section.
 # No need to generate them if there are no CONFIG_FILES.
@@ -19517,7 +19559,7 @@ if test "x$ac_cr" = x; then
 fi
 ac_cs_awk_cr=`$AWK 'BEGIN { print "a\rb" }' </dev/null 2>/dev/null`
 if test "$ac_cs_awk_cr" = "a${ac_cr}b"; then
-  ac_cs_awk_cr='\r'
+  ac_cs_awk_cr='\\r'
 else
   ac_cs_awk_cr=$ac_cr
 fi
@@ -19531,18 +19573,18 @@ _ACEOF
   echo "$ac_subst_vars" | sed 's/.*/&!$&$ac_delim/' &&
   echo "_ACEOF"
 } >conf$$subs.sh ||
-  as_fn_error "could not make $CONFIG_STATUS" "$LINENO" 5
-ac_delim_num=`echo "$ac_subst_vars" | grep -c '$'`
+  as_fn_error $? "could not make $CONFIG_STATUS" "$LINENO" 5
+ac_delim_num=`echo "$ac_subst_vars" | grep -c '^'`
 ac_delim='%!_!# '
 for ac_last_try in false false false false false :; do
   . ./conf$$subs.sh ||
-    as_fn_error "could not make $CONFIG_STATUS" "$LINENO" 5
+    as_fn_error $? "could not make $CONFIG_STATUS" "$LINENO" 5
 
   ac_delim_n=`sed -n "s/.*$ac_delim\$/X/p" conf$$subs.awk | grep -c X`
   if test $ac_delim_n = $ac_delim_num; then
     break
   elif $ac_last_try; then
-    as_fn_error "could not make $CONFIG_STATUS" "$LINENO" 5
+    as_fn_error $? "could not make $CONFIG_STATUS" "$LINENO" 5
   else
     ac_delim="$ac_delim!$ac_delim _$ac_delim!! "
   fi
@@ -19631,20 +19673,28 @@ if sed "s/$ac_cr//" < /dev/null > /dev/n
 else
   cat
 fi < "$tmp/subs1.awk" > "$tmp/subs.awk" \
-  || as_fn_error "could not setup config files machinery" "$LINENO" 5
+  || as_fn_error $? "could not setup config files machinery" "$LINENO" 5
 _ACEOF
 
-# VPATH may cause trouble with some makes, so we remove $(srcdir),
-# ${srcdir} and @srcdir@ from VPATH if srcdir is ".", strip leading and
+# VPATH may cause trouble with some makes, so we remove sole $(srcdir),
+# ${srcdir} and @srcdir@ entries from VPATH if srcdir is ".", strip leading and
 # trailing colons and then remove the whole line if VPATH becomes empty
 # (actually we leave an empty line to preserve line numbers).
 if test "x$srcdir" = x.; then
-  ac_vpsub='/^[	 ]*VPATH[	 ]*=/{
-s/:*\$(srcdir):*/:/
-s/:*\${srcdir}:*/:/
-s/:*@srcdir@:*/:/
-s/^\([^=]*=[	 ]*\):*/\1/
+  ac_vpsub='/^[	 ]*VPATH[	 ]*=[	 ]*/{
+h
+s///
+s/^/:/
+s/[	 ]*$/:/
+s/:\$(srcdir):/:/g
+s/:\${srcdir}:/:/g
+s/:@srcdir@:/:/g
+s/^:*//
 s/:*$//
+x
+s/\(=[	 ]*\).*/\1/
+G
+s/\n//
 s/^[^=]*=[	 ]*$//
 }'
 fi
@@ -19672,7 +19722,7 @@ for ac_last_try in false false :; do
   if test -z "$ac_t"; then
     break
   elif $ac_last_try; then
-    as_fn_error "could not make $CONFIG_HEADERS" "$LINENO" 5
+    as_fn_error $? "could not make $CONFIG_HEADERS" "$LINENO" 5
   else
     ac_delim="$ac_delim!$ac_delim _$ac_delim!! "
   fi
@@ -19757,7 +19807,7 @@ cat >>$CONFIG_STATUS <<_ACEOF || ac_writ
 _ACAWK
 _ACEOF
 cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
-  as_fn_error "could not setup config headers machinery" "$LINENO" 5
+  as_fn_error $? "could not setup config headers machinery" "$LINENO" 5
 fi # test -n "$CONFIG_HEADERS"
 
 
@@ -19770,7 +19820,7 @@ do
   esac
   case $ac_mode$ac_tag in
   :[FHL]*:*);;
-  :L* | :C*:*) as_fn_error "invalid tag \`$ac_tag'" "$LINENO" 5;;
+  :L* | :C*:*) as_fn_error $? "invalid tag \`$ac_tag'" "$LINENO" 5 ;;
   :[FH]-) ac_tag=-:-;;
   :[FH]*) ac_tag=$ac_tag:$ac_tag.in;;
   esac
@@ -19798,7 +19848,7 @@ do
 	   [\\/$]*) false;;
 	   *) test -f "$srcdir/$ac_f" && ac_f="$srcdir/$ac_f";;
 	   esac ||
-	   as_fn_error "cannot find input file: \`$ac_f'" "$LINENO" 5;;
+	   as_fn_error 1 "cannot find input file: \`$ac_f'" "$LINENO" 5 ;;
       esac
       case $ac_f in *\'*) ac_f=`$as_echo "$ac_f" | sed "s/'/'\\\\\\\\''/g"`;; esac
       as_fn_append ac_file_inputs " '$ac_f'"
@@ -19825,7 +19875,7 @@ $as_echo "$as_me: creating $ac_file" >&6
 
     case $ac_tag in
     *:-:* | *:-) cat >"$tmp/stdin" \
-      || as_fn_error "could not create $ac_file" "$LINENO" 5 ;;
+      || as_fn_error $? "could not create $ac_file" "$LINENO" 5  ;;
     esac
     ;;
   esac
@@ -19951,22 +20001,22 @@ s&@abs_top_builddir@&$ac_abs_top_builddi
 $ac_datarootdir_hack
 "
 eval sed \"\$ac_sed_extra\" "$ac_file_inputs" | $AWK -f "$tmp/subs.awk" >$tmp/out \
-  || as_fn_error "could not create $ac_file" "$LINENO" 5
+  || as_fn_error $? "could not create $ac_file" "$LINENO" 5
 
 test -z "$ac_datarootdir_hack$ac_datarootdir_seen" &&
   { ac_out=`sed -n '/\${datarootdir}/p' "$tmp/out"`; test -n "$ac_out"; } &&
   { ac_out=`sed -n '/^[	 ]*datarootdir[	 ]*:*=/p' "$tmp/out"`; test -z "$ac_out"; } &&
   { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $ac_file contains a reference to the variable \`datarootdir'
-which seems to be undefined.  Please make sure it is defined." >&5
+which seems to be undefined.  Please make sure it is defined" >&5
 $as_echo "$as_me: WARNING: $ac_file contains a reference to the variable \`datarootdir'
-which seems to be undefined.  Please make sure it is defined." >&2;}
+which seems to be undefined.  Please make sure it is defined" >&2;}
 
   rm -f "$tmp/stdin"
   case $ac_file in
   -) cat "$tmp/out" && rm -f "$tmp/out";;
   *) rm -f "$ac_file" && mv "$tmp/out" "$ac_file";;
   esac \
-  || as_fn_error "could not create $ac_file" "$LINENO" 5
+  || as_fn_error $? "could not create $ac_file" "$LINENO" 5
  ;;
   :H)
   #
@@ -19977,19 +20027,19 @@ which seems to be undefined.  Please mak
       $as_echo "/* $configure_input  */" \
       && eval '$AWK -f "$tmp/defines.awk"' "$ac_file_inputs"
     } >"$tmp/config.h" \
-      || as_fn_error "could not create $ac_file" "$LINENO" 5
+      || as_fn_error $? "could not create $ac_file" "$LINENO" 5
     if diff "$ac_file" "$tmp/config.h" >/dev/null 2>&1; then
       { $as_echo "$as_me:${as_lineno-$LINENO}: $ac_file is unchanged" >&5
 $as_echo "$as_me: $ac_file is unchanged" >&6;}
     else
       rm -f "$ac_file"
       mv "$tmp/config.h" "$ac_file" \
-	|| as_fn_error "could not create $ac_file" "$LINENO" 5
+	|| as_fn_error $? "could not create $ac_file" "$LINENO" 5
     fi
   else
     $as_echo "/* $configure_input  */" \
       && eval '$AWK -f "$tmp/defines.awk"' "$ac_file_inputs" \
-      || as_fn_error "could not create -" "$LINENO" 5
+      || as_fn_error $? "could not create -" "$LINENO" 5
   fi
  ;;
 
@@ -20645,7 +20695,7 @@ _ACEOF
 ac_clean_files=$ac_clean_files_save
 
 test $ac_write_fail = 0 ||
-  as_fn_error "write failure creating $CONFIG_STATUS" "$LINENO" 5
+  as_fn_error $? "write failure creating $CONFIG_STATUS" "$LINENO" 5
 
 
 # configure is writing to config.log, and then calls config.status.
@@ -20666,7 +20716,7 @@ if test "$no_create" != yes; then
   exec 5>>config.log
   # Use ||, not &&, to avoid exiting from the if with $? = 1, which
   # would make configure fail if this is the last instruction.
-  $ac_cs_success || as_fn_exit $?
+  $ac_cs_success || as_fn_exit 1
 fi
 if test -n "$ac_unrecognized_opts" && test "$enable_option_checking" != no; then
   { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: unrecognized options: $ac_unrecognized_opts" >&5
