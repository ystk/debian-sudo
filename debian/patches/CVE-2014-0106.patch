Description: CVE-2014-0106: security policy bypass when env_reset is disabled
 Fix logic inversion when checking environment variables on the
 command line against the blacklist.  This is only a problem when
 env_reset is disabled.
Origin: http://www.sudo.ws/repos/sudo/rev/748cefb49422
Author: Todd C. Miller <Todd.Miller@courtesan.com>
Last-Update: 2015-02-27
Applied-Upstream: 1.8.5

--- a/env.c
+++ b/env.c
@@ -927,7 +927,7 @@ validate_env_vars(env_vars)
 		okvar = matches_env_keep(var->value);
 	} else {
 	    okvar = matches_env_delete(var->value) == FALSE;
-	    if (okvar == FALSE)
+	    if (okvar == TRUE)
 		okvar = matches_env_check(var->value) != FALSE;
 	}
 	if (okvar == FALSE) {
