Description: Prevent IPv6 netmask-based address matching logic from incorrectly
 being applied to IPv4 addresses.
Author: Todd C. Miller <Todd.Miller@courtesan.com>

Index: sudo-1.7.4p4/match.c
===================================================================
--- sudo-1.7.4p4.orig/match.c	2010-09-03 16:40:19.000000000 -0500
+++ sudo-1.7.4p4/match.c	2012-05-14 17:46:29.042918270 -0500
@@ -645,6 +645,7 @@
 		}
 		if (j == sizeof(addr.ip6.s6_addr))
 		    return(TRUE);
+		break;
 #endif
 	}
     }
@@ -706,10 +707,11 @@
 	ifp = &interfaces[i];
 	if (ifp->family != family)
 	    continue;
-	switch(family) {
+	switch (family) {
 	    case AF_INET:
 		if ((ifp->addr.ip4.s_addr & mask.ip4.s_addr) == addr.ip4.s_addr)
 		    return(TRUE);
+		break;
 #ifdef HAVE_IN6_ADDR
 	    case AF_INET6:
 		for (j = 0; j < sizeof(addr.ip6.s6_addr); j++) {
@@ -718,6 +720,7 @@
 		}
 		if (j == sizeof(addr.ip6.s6_addr))
 		    return(TRUE);
+		break;
 #endif /* HAVE_IN6_ADDR */
 	}
     }
